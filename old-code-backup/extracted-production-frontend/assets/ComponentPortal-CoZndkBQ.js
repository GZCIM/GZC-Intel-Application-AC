import{j as l,m as $}from"./ui-vendor-D_lBo_Av.js";import{r as u}from"./react-vendor-DV3-pNU7.js";import{c as y,u as R}from"./index-BPkj35Ov.js";class j{static validateContract(e){const t=[],o=[];let n=100;const r=this.validateMetadata(e.metadata);t.push(...r.errors),o.push(...r.warnings),n-=r.penaltyPoints;const p=this.validateCapabilities(e.capabilities);t.push(...p.errors),o.push(...p.warnings),n-=p.penaltyPoints;const a=this.validateLifecycle(e.lifecycle);t.push(...a.errors),o.push(...a.warnings),n-=a.penaltyPoints;const c=this.validateDataContract(e.dataContract);return t.push(...c.errors),o.push(...c.warnings),n-=c.penaltyPoints,{valid:t.length===0,errors:t,warnings:o,score:Math.max(0,n)}}static validateMetadata(e){const t=[],o=[];let n=0;e.id||(t.push("Component ID is required"),n+=20),e.name||(t.push("Component name is required"),n+=20),e.displayName||(t.push("Component display name is required"),n+=10),e.version||(t.push("Component version is required"),n+=15),e.category||(t.push("Component category is required"),n+=15),e.description||(o.push("Component description is missing"),n+=5),e.version&&!/^\d+\.\d+\.\d+$/.test(e.version)&&(o.push("Version should follow semantic versioning (x.y.z)"),n+=5);const r=["trading","analytics","portfolio","market-data","admin","docs"];return e.category&&!r.includes(e.category)&&(t.push(`Invalid category. Must be one of: ${r.join(", ")}`),n+=10),{errors:t,warnings:o,penaltyPoints:n}}static validateCapabilities(e){const t=[],o=[];let n=0;return e?(e.sizing?(typeof e.sizing.resizable!="boolean"&&(t.push("Sizing.resizable must be boolean"),n+=10),typeof e.sizing.responsive!="boolean"&&(o.push("Sizing.responsive should be defined"),n+=5)):(t.push("Sizing capabilities are required"),n+=20),e.modes?["standalone","widget","embedded","modal"].some(a=>e.modes[a]===!0)||(t.push("Component must support at least one interaction mode"),n+=15):(t.push("Interaction modes are required"),n+=20),e.performance?(["low","medium","high"].includes(e.performance.renderComplexity)||(o.push("Invalid render complexity level"),n+=5),["light","moderate","heavy"].includes(e.performance.memoryUsage)||(o.push("Invalid memory usage level"),n+=5)):(o.push("Performance characteristics should be defined"),n+=10),{errors:t,warnings:o,penaltyPoints:n}):(t.push("Component capabilities are required"),{errors:t,warnings:o,penaltyPoints:50})}static validateLifecycle(e){const t=[],o=[];let n=0;if(!e)return t.push("Component lifecycle is required"),{errors:t,warnings:o,penaltyPoints:30};const r=["initialize","onMount","onResize","onUnmount"];for(const a of r)typeof e[a]!="function"&&(t.push(`Lifecycle method '${a}' is required`),n+=10);const p=["onError","onDataUpdate"];for(const a of p)typeof e[a]!="function"&&(o.push(`Lifecycle method '${a}' is recommended`),n+=2);return{errors:t,warnings:o,penaltyPoints:n}}static validateDataContract(e){const t=[],o=[];let n=0;return e?(Array.isArray(e.inputs)?e.inputs.forEach((r,p)=>{r.id||(t.push(`Input ${p}: ID is required`),n+=5),r.type||(t.push(`Input ${p}: Type is required`),n+=5),typeof r.required!="boolean"&&(o.push(`Input ${p}: Required flag should be boolean`),n+=2)}):(t.push("Data contract inputs must be an array"),n+=15),Array.isArray(e.outputs)||(t.push("Data contract outputs must be an array"),n+=15),{errors:t,warnings:o,penaltyPoints:n}):(t.push("Data contract is required"),{errors:t,warnings:o,penaltyPoints:25})}static validateRegistryEntry(e){const t=this.validateContract(e.contract),o=[...t.errors],n=[...t.warnings];let r=t.score;return e.component||(o.push("Component implementation is required"),r-=20),e.loader||(o.push("Component loader is required"),r-=15),e.status||(n.push("Component status should be defined"),r-=5),{valid:o.length===0,errors:o,warnings:n,score:Math.max(0,r)}}static generateComplianceReport(e){const t=this.validateContract(e);let o=`Component Compliance Report
`;return o+=`Component: ${e.metadata.name} v${e.metadata.version}
`,o+=`Score: ${t.score}/100

`,t.errors.length>0&&(o+=`ERRORS (${t.errors.length}):
`,t.errors.forEach((n,r)=>{o+=`  ${r+1}. ${n}
`}),o+=`
`),t.warnings.length>0&&(o+=`WARNINGS (${t.warnings.length}):
`,t.warnings.forEach((n,r)=>{o+=`  ${r+1}. ${n}
`}),o+=`
`),t.valid?o+=`✅ Component meets professional standards
`:o+=`❌ Component does not meet professional standards
`,o}}class I{validator=new j;async fetchFromPort3200(e){try{const t=await fetch(`http://localhost:3200/api/components/${e}`);if(!t.ok)throw new Error(`Failed to fetch component: ${t.statusText}`);return await t.json()}catch(t){return console.error("Error fetching component from port 3200:",t),null}}async listPort3200Components(){try{const e=await fetch("http://localhost:3200/api/components");if(!e.ok)throw new Error(`Failed to list components: ${e.statusText}`);return await e.json()}catch(e){return console.error("Error listing components from port 3200:",e),[]}}migrateToContract(e){return{metadata:{id:e.id,name:e.name,displayName:e.name.replace(/([A-Z])/g," $1").trim(),version:"1.0.0",description:e.description,author:"Port 3200 Import",category:e.config?.category||"imported",tags:e.config?.tags||["imported","port-3200"],dependencies:[],repository:"http://localhost:3200"},capabilities:{sizing:{defaultSize:{width:e.config?.size?.width||400,height:e.config?.size?.height||300},minSize:{width:200,height:150},maxSize:{width:800,height:600},resizable:!0,aspectRatio:null},modes:{display:["full","compact"],interaction:["view","edit"],themes:["light","dark"]},features:{realtime:!1,offline:!1,collaborative:!1,exportable:!0,printable:!1},performance:{renderTime:100,updateInterval:null,maxDataPoints:1e3,throttle:null}},lifecycle:{onMount:"componentDidMount",onUnmount:"componentWillUnmount",onUpdate:"componentDidUpdate",onError:"componentDidCatch",onResize:null,onThemeChange:null,onModeChange:null},dataContract:{props:{required:[],optional:[{name:"config",type:"object",description:"Component configuration"}]},state:{managed:[],exposed:[]},events:{emitted:[],handled:[]},methods:{public:[],private:[]}}}}async validateImport(e){const t=this.migrateToContract(e),o=this.validator.validateComponent(t);return{valid:o.score>=70,report:o}}async importComponent(e){try{const t=await this.fetchFromPort3200(e);if(!t)return{success:!1,errors:[`Component ${e} not found on port 3200`]};const{valid:o,report:n}=await this.validateImport(t);if(!o)return{success:!1,errors:n.errors.map(a=>a.message),warnings:n.warnings.map(a=>a.message)};const r=this.migrateToContract(t);return await this.writeComponentFile(t)?(y.addComponent({id:r.metadata.id,name:r.metadata.name,displayName:r.metadata.displayName,category:r.metadata.category,description:r.metadata.description,defaultSize:{w:Math.round(r.capabilities.sizing.defaultSize.width/100),h:Math.round(r.capabilities.sizing.defaultSize.height/100)},minSize:{w:Math.round(r.capabilities.sizing.minSize.width/100),h:Math.round(r.capabilities.sizing.minSize.height/100)},tags:r.metadata.tags,complexity:"medium",quality:"port-3200",source:"port-3200"}),{success:!0,componentId:r.metadata.id,warnings:n.warnings.map(a=>a.message)}):{success:!1,errors:["Failed to write component file"]}}catch(t){return{success:!1,errors:[`Import failed: ${t.message}`]}}}async writeComponentFile(e){try{console.log(`Would write component ${e.id} to /src/components/imported/${e.id}.tsx`);const t=`
import React from 'react'
import { useTheme } from '../../contexts/ThemeContext'

// Imported from Port 3200
export const ${e.name}: React.FC<any> = (props) => {
  const { currentTheme } = useTheme()
  
  return (
    <div style={{
      width: '100%',
      height: '100%',
      backgroundColor: currentTheme.surface,
      padding: '16px',
      borderRadius: '8px'
    }}>
      <h3>${e.name}</h3>
      <p>${e.description}</p>
      {/* Original component code would go here */}
    </div>
  )
}
`;return`/src/components/imported/${e.id}.tsx`}catch(t){return console.error("Failed to write component file:",t),null}}async importMultiple(e){const t=new Map;for(const o of e){const n=await this.importComponent(o);t.set(o,n)}return t}}class P{async exportComponent(e){const t=y.getComponent(e);return t?{id:t.id,name:t.name,displayName:t.displayName,description:t.description,version:"1.0.0",source:"port-3500",contract:this.buildContract(t),implementation:{path:`/components/widgets/${t.name}.tsx`,dependencies:t.dependencies||[]},metadata:t}:(console.error(`Component ${e} not found`),null)}buildContract(e){return{metadata:{id:e.id,name:e.name,displayName:e.displayName,version:"1.0.0",description:e.description,author:"GZC Intel App",category:e.category,tags:e.tags,dependencies:e.dependencies||[],repository:"http://localhost:3500"},capabilities:{sizing:{defaultSize:{width:e.defaultSize.w*100,height:e.defaultSize.h*100},minSize:{width:e.minSize.w*100,height:e.minSize.h*100},maxSize:e.maxSize?{width:e.maxSize.w*100,height:e.maxSize.h*100}:null,resizable:e.canResize!==!1,aspectRatio:null},modes:{display:["full","compact"],interaction:["view","edit"],themes:["light","dark"]},features:{realtime:e.tags.includes("real-time"),offline:!1,collaborative:!1,exportable:!0,printable:!1},performance:{renderTime:100,updateInterval:e.tags.includes("real-time")?1e3:null,maxDataPoints:1e3,throttle:null}},lifecycle:{onMount:"useEffect",onUnmount:"cleanup",onUpdate:"deps",onError:"errorBoundary",onResize:e.canResize?"handleResize":null,onThemeChange:"useTheme",onModeChange:null},dataContract:{props:{required:[],optional:Object.entries(e.props||{}).map(([t,o])=>({name:t,type:typeof o,description:`${t} property`,default:o}))},state:{managed:[],exposed:[]},events:{emitted:[],handled:[]},methods:{public:[],private:[]}}}}async exportAsPackage(e){const t=await this.exportComponent(e);if(!t)return null;const o={name:`@gzc-intel/${t.id}`,version:t.version,description:t.description,main:"index.js",types:"index.d.ts",exports:{".":"./index.js","./contract":"./contract.json"},peerDependencies:{react:"^18.0.0","react-dom":"^18.0.0"},dependencies:t.implementation.dependencies.reduce((p,a)=>(p[a]="*",p),{}),gzcIntel:{componentId:t.id,source:t.source,quality:t.metadata.quality,contract:t.contract}},n=`# ${t.displayName}

${t.description}

## Installation

\`\`\`bash
npm install @gzc-intel/${t.id}
\`\`\`

## Usage

\`\`\`tsx
import { ${t.name} } from '@gzc-intel/${t.id}'

function App() {
  return <${t.name} />
}
\`\`\`

## Component Contract

- **Category**: ${t.metadata.category}
- **Tags**: ${t.metadata.tags.join(", ")}
- **Quality**: ${t.metadata.quality}
- **Source**: ${t.source}

## Props

${t.contract.dataContract.props.optional.map(p=>`- **${p.name}** (${p.type}): ${p.description}`).join(`
`)}
`,r=await this.getComponentSource(e);return{packageJson:o,componentCode:r||"// Component implementation",readme:n}}async getComponentSource(e){return`import React from 'react'

export const Component: React.FC = (props) => {
  // Component implementation
  return <div>Component ${e}</div>
}`}async exportMultiple(e){const t=new Map;for(const o of e){const n=await this.exportComponent(o);n&&t.set(o,n)}return t}async generateManifest(e){const t=[];for(const o of e){const n=await this.exportComponent(o);n&&t.push(n)}return{version:"1.0.0",timestamp:new Date().toISOString(),source:"port-3500",components:t}}}const q=new P,D=()=>{const{currentTheme:i}=R(),[e,t]=u.useState("import"),[o,n]=u.useState([]),[r,p]=u.useState([]),[a,c]=u.useState(!1),[m,h]=u.useState(new Set),[f,C]=u.useState(new Map),x=new I;u.useEffect(()=>{e==="import"?w():v()},[e]);const w=async()=>{c(!0);try{const s=await x.listPort3200Components();n(s)}catch(s){console.error("Failed to load port 3200 components:",s),n([{id:"advanced-chart",name:"AdvancedChart",description:"Professional trading chart with indicators",quality:"port-3200"},{id:"portfolio-grid",name:"PortfolioGrid",description:"Real-time portfolio holdings grid",quality:"port-3200"},{id:"order-book",name:"OrderBook",description:"Live order book visualization",quality:"port-3200"}])}finally{c(!1)}},v=()=>{const s=y.searchComponents("").filter(d=>d.source==="internal"||d.quality==="enhanced");p(s)},b=async()=>{c(!0);const s=new Map;for(const d of m)try{const g=await x.importComponent(d);s.set(d,g)}catch(g){s.set(d,{success:!1,errors:[`Import failed: ${g.message}`]})}C(s),h(new Set),c(!1)},z=async()=>{c(!0);for(const s of m)try{const d=await q.exportAsPackage(s);d&&console.log(`Exported ${s}:`,d)}catch(d){console.error(`Failed to export ${s}:`,d)}h(new Set),c(!1)},S=s=>{const d=new Set(m);d.has(s)?d.delete(s):d.add(s),h(d)};return l.jsxs("div",{style:{height:"100%",width:"100%",backgroundColor:i.background,display:"flex",flexDirection:"column"},children:[l.jsxs("div",{style:{padding:"16px 24px",backgroundColor:i.surface,borderBottom:`1px solid ${i.border}`,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsx("h2",{style:{margin:0,fontSize:"18px",fontWeight:"600",color:i.text},children:"Component Portal"}),l.jsxs("div",{style:{display:"flex",gap:"12px"},children:[l.jsx("button",{onClick:()=>t("import"),style:{padding:"8px 16px",backgroundColor:e==="import"?i.primary:"transparent",color:e==="import"?"white":i.text,border:`1px solid ${i.border}`,borderRadius:"6px",cursor:"pointer",fontSize:"12px"},children:"Import from 3200"}),l.jsx("button",{onClick:()=>t("export"),style:{padding:"8px 16px",backgroundColor:e==="export"?i.primary:"transparent",color:e==="export"?"white":i.text,border:`1px solid ${i.border}`,borderRadius:"6px",cursor:"pointer",fontSize:"12px"},children:"Export to 3200"})]})]}),l.jsx("div",{style:{flex:1,padding:"24px",overflowY:"auto"},children:a?l.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:i.textSecondary},children:"Loading components..."}):l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px"},children:(e==="import"?o:r).map(s=>l.jsxs($.div,{whileHover:{scale:1.02},onClick:()=>S(s.id),style:{padding:"16px",backgroundColor:i.surface,border:`2px solid ${m.has(s.id)?i.primary:i.border}`,borderRadius:"8px",cursor:"pointer",position:"relative"},children:[l.jsx("div",{style:{position:"absolute",top:"12px",right:"12px",width:"20px",height:"20px",borderRadius:"4px",border:`2px solid ${i.border}`,backgroundColor:m.has(s.id)?i.primary:"transparent",display:"flex",alignItems:"center",justifyContent:"center"},children:m.has(s.id)&&l.jsx("span",{style:{color:"white",fontSize:"12px"},children:"✓"})}),l.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"14px",fontWeight:"600",color:i.text},children:s.name||s.displayName}),l.jsx("p",{style:{margin:"0 0 12px 0",fontSize:"12px",color:i.textSecondary,lineHeight:1.4},children:s.description}),l.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[l.jsx("span",{style:{fontSize:"10px",padding:"2px 8px",backgroundColor:`${i.primary}20`,color:i.primary,borderRadius:"4px"},children:s.quality||"quality"}),s.tags?.slice(0,2).map(d=>l.jsx("span",{style:{fontSize:"10px",padding:"2px 8px",backgroundColor:`${i.border}`,color:i.textSecondary,borderRadius:"4px"},children:d},d))]}),f.has(s.id)&&l.jsx("div",{style:{marginTop:"12px",padding:"8px",backgroundColor:f.get(s.id).success?`${i.success}20`:`${i.danger}20`,borderRadius:"4px",fontSize:"11px"},children:f.get(s.id).success?"✅ Imported":"❌ Failed"})]},s.id))})}),m.size>0&&l.jsxs("div",{style:{padding:"16px 24px",backgroundColor:i.surface,borderTop:`1px solid ${i.border}`,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[l.jsxs("span",{style:{fontSize:"12px",color:i.textSecondary},children:[m.size," component",m.size!==1?"s":""," selected"]}),l.jsx("button",{onClick:e==="import"?b:z,disabled:a,style:{padding:"8px 24px",backgroundColor:i.primary,color:"white",border:"none",borderRadius:"6px",cursor:a?"not-allowed":"pointer",fontSize:"12px",opacity:a?.6:1},children:a?"Processing...":e==="import"?"Import Selected":"Export Selected"})]})]})};export{D as ComponentPortal};
//# sourceMappingURL=ComponentPortal-CoZndkBQ.js.map
