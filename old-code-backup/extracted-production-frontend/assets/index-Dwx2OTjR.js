import{C as B,a as F}from"./DynamicCanvas-BDIMwBGE.js";import{D as N}from"./DynamicCanvas-BDIMwBGE.js";import{j as n,m as f}from"./ui-vendor-D_lBo_Av.js";import{r}from"./react-vendor-DV3-pNU7.js";import{u as P,a as U,b as H,c as _}from"./index-BPkj35Ov.js";const O=[{id:"header",x:0,y:0,width:100,height:15,locked:!0},{id:"main-left",x:0,y:15,width:60,height:70},{id:"main-right",x:60,y:15,width:40,height:70},{id:"footer",x:0,y:85,width:100,height:15,locked:!0}],G=({tabId:d})=>{const{currentTheme:c}=P(),{currentLayout:v,updateTab:S}=U(),{saveLayout:w,loadLayout:C}=H(),[h,p]=r.useState(O),[g,m]=r.useState(null),[b,l]=r.useState(!1),[j,y]=r.useState(null),[W,k]=r.useState(null),[z,u]=r.useState(!1),x=v?.tabs.find(e=>e.id===d),a=x?.editMode||!1;r.useEffect(()=>{(async()=>{const t=await C(`static-canvas-${d}`);if(t)p(t);else if(x?.components&&x.components.length>0){const i=x.components.map(o=>({id:o.id,x:o.position.x,y:o.position.y,width:o.position.w,height:o.position.h,componentId:o.type==="empty"?void 0:o.type,locked:!1}));p(i)}})()},[d,x?.components]),r.useEffect(()=>{const e=t=>{t.detail.tabId===d&&I()};return window.addEventListener("save-static-tab",e),()=>window.removeEventListener("save-static-tab",e)},[d,h]);const I=async()=>{const e=h.map(t=>({id:t.id,type:t.componentId||"empty",position:{x:t.x,y:t.y,w:t.width,h:t.height},props:{},zIndex:0}));S(d,{components:e}),await w(`static-canvas-${d}`,h),l(!1)},E=(e,t)=>{p(i=>i.map(o=>o.id===e?{...o,componentId:t.id}:o)),l(!0),m(null)},L=()=>{const e={id:`slot_${Date.now()}`,x:10,y:10,width:30,height:30,locked:!1};p(t=>[...t,e]),l(!0)},M=e=>{p(t=>t.filter(i=>i.id!==e)),l(!0)},T=e=>{p(t=>t.map(i=>i.id===e?{...i,componentId:void 0}:i)),l(!0)},R=(e,t,i)=>{p(o=>o.map(s=>s.id===e&&!s.locked?{...s,x:Math.max(0,Math.min(100-s.width,s.x+t)),y:Math.max(0,Math.min(100-s.height,s.y+i))}:s)),l(!0)},$=e=>e.componentId?n.jsx(F,{componentId:e.componentId,instanceId:`${e.id}_${e.componentId}`,props:{},isEditMode:a,onRemove:()=>T(e.id)}):n.jsx("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",border:`2px dashed ${c.border}`,borderRadius:"8px",color:c.textSecondary,fontSize:"12px",textAlign:"center",padding:"16px"},children:a?n.jsx(n.Fragment,{children:n.jsxs("div",{children:[n.jsx("div",{style:{marginBottom:"8px",fontSize:"24px",opacity:.5},children:"📦"}),n.jsx("div",{children:"Click to add component"}),n.jsxs("div",{style:{fontSize:"10px",opacity:.7,marginTop:"4px"},children:["Slot: ",e.id]})]})}):n.jsx(n.Fragment,{children:n.jsxs("div",{children:[n.jsx("div",{style:{marginBottom:"8px",fontSize:"24px",opacity:.3},children:"📄"}),n.jsx("div",{children:"Empty slot"})]})})});return n.jsxs("div",{style:{height:"100%",width:"100%",backgroundColor:c.background,position:"relative"},children:[b&&n.jsx("div",{style:{position:"absolute",top:"12px",left:"50%",transform:"translateX(-50%)",padding:"6px 12px",backgroundColor:"#f59e0b",color:"white",fontSize:"11px",borderRadius:"6px",zIndex:999},children:"⚠️ Unsaved changes - Click Save to persist"}),a&&n.jsx("div",{style:{position:"absolute",bottom:"16px",right:"16px",display:"flex",gap:"8px",zIndex:1e3},children:n.jsxs(f.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:L,style:{padding:"8px 16px",backgroundColor:c.primary,color:"white",border:"none",borderRadius:"6px",fontSize:"12px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[n.jsx("span",{children:"➕"})," Add Slot"]})}),n.jsxs("div",{style:{height:"100%",width:"100%",padding:"16px",position:"relative"},children:[h.map(e=>n.jsxs(f.div,{drag:a&&!e.locked,dragMomentum:!1,dragElastic:!1,onDragEnd:(t,i)=>{const o=t.currentTarget.parentElement;if(!o)return;const s=o.getBoundingClientRect(),D=i.offset.x/s.width*100,A=i.offset.y/s.height*100;R(e.id,D,A),y(null)},onDragStart:()=>y(e.id),onClick:()=>{a&&!e.componentId&&(m(e.id),u(!0))},whileHover:a&&!e.componentId?{scale:1.02}:{},style:{position:"absolute",left:`${e.x}%`,top:`${e.y}%`,width:`${e.width}%`,height:`${e.height}%`,cursor:a?e.locked?"not-allowed":"move":"default",transition:j===e.id?"none":"all 0.2s ease"},children:[a&&n.jsxs(n.Fragment,{children:[!e.locked&&n.jsx("button",{onClick:t=>{t.stopPropagation(),M(e.id)},style:{position:"absolute",top:"-8px",right:"-8px",width:"20px",height:"20px",borderRadius:"50%",backgroundColor:c.danger,color:"white",border:"none",cursor:"pointer",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},children:"×"}),!e.locked&&n.jsx("div",{onMouseDown:t=>{t.stopPropagation(),k(e.id)},style:{position:"absolute",bottom:"-4px",right:"-4px",width:"12px",height:"12px",backgroundColor:c.primary,cursor:"nwse-resize",borderRadius:"2px"}})]}),$(e)]},e.id)),h.every(e=>!e.componentId)&&!a&&n.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",color:c.textSecondary},children:[n.jsx("div",{style:{fontSize:"48px",marginBottom:"16px",opacity:.3},children:"📋"}),n.jsx("div",{style:{fontSize:"16px",fontWeight:"500",marginBottom:"8px"},children:"Static Canvas"}),n.jsx("div",{style:{fontSize:"12px",maxWidth:"300px"},children:"This tab uses a fixed layout. Click Edit to assign components to specific slots."})]})]}),n.jsx(B,{isOpen:z,onClose:()=>{u(!1),m(null)},onComponentSelect:e=>{if(g){const t=_.getComponent(e);t&&E(g,t)}u(!1),m(null)}})]})};export{F as ComponentRenderer,N as DynamicCanvas,G as StaticCanvas};
//# sourceMappingURL=index-Dwx2OTjR.js.map
